<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hermes API Documentation</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f7f8fa;
            --bg-code: #1a1a2e;
            --text-primary: #1a1a2e;
            --text-secondary: #6b7280;
            --text-code: #e2e8f0;
            --border-color: #e5e7eb;
            --accent-color: #4f46e5;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-code: #0f0f1a;
            --text-primary: #e2e8f0;
            --text-secondary: #9ca3af;
            --text-code: #e2e8f0;
            --border-color: #374151;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }

        header {
            border-bottom: 1px solid var(--border-color);
            padding: 24px 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-color);
        }

        .theme-toggle {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-primary);
        }

        nav {
            background: var(--bg-secondary);
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 24px;
        }

        nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }

        nav a:hover {
            color: var(--accent-color);
        }

        main {
            padding: 48px 0;
        }

        section {
            margin-bottom: 64px;
        }

        h1 {
            font-size: 36px;
            margin-bottom: 16px;
        }

        h2 {
            font-size: 28px;
            margin-bottom: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
        }

        h3 {
            font-size: 20px;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 16px;
            color: var(--text-secondary);
        }

        .endpoint {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .method {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 14px;
            margin-right: 12px;
        }

        .method.post {
            background: var(--success-color);
            color: white;
        }

        .method.get {
            background: var(--accent-color);
            color: white;
        }

        .path {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 16px;
        }

        pre {
            background: var(--bg-code);
            color: var(--text-code);
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 16px 0;
            font-size: 14px;
        }

        code {
            font-family: 'Monaco', 'Menlo', monospace;
        }

        .inline-code {
            background: var(--bg-secondary);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 14px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }

        th, td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            font-weight: 600;
            color: var(--text-primary);
        }

        td {
            color: var(--text-secondary);
        }

        .required {
            color: var(--error-color);
            font-size: 12px;
        }

        .optional {
            color: var(--text-secondary);
            font-size: 12px;
        }

        /* Cost Calculator Styles */
        .calculator {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 32px;
            max-width: 500px;
        }

        .calculator h3 {
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .result {
            margin-top: 24px;
            padding: 20px;
            background: var(--bg-primary);
            border-radius: 6px;
            text-align: center;
        }

        .result-amount {
            font-size: 32px;
            font-weight: 700;
            color: var(--accent-color);
        }

        .result-note {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 24px;
        }

        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .tab.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .note-box {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
        }

        [data-theme="dark"] .note-box {
            background: #422006;
            border-color: #92400e;
        }

        .note-box strong {
            color: #92400e;
        }

        [data-theme="dark"] .note-box strong {
            color: #fbbf24;
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">Hermes</div>
            <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
        </div>
    </header>

    <nav>
        <div class="container">
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#authentication">Authentication</a></li>
                <li><a href="#endpoints">Endpoints</a></li>
                <li><a href="#orders">Orders</a></li>
                <li><a href="#calculator">Cost Calculator</a></li>
                <li><a href="#rubber-stamps">Rubber Stamps</a></li>
                <li><a href="#examples">Examples</a></li>
                <li><a href="#playground">API Playground</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="container">
            <section id="overview">
                <h1>Hermes</h1>
                <p>A wrapper API for Hack Club's Theseus mail system. Create letters, track costs, and manage events with ease.</p>
            </section>

            <section id="authentication">
                <h2>Authentication</h2>
                <p>All API requests require authentication using a Bearer token in the Authorization header.</p>
                
                <h3>Event API Keys</h3>
                <p>Each event has its own API key. Use this key to create letters for that event.</p>
                <pre><code>Authorization: Bearer your_event_api_key</code></pre>

                <h3>Admin API Key</h3>
                <p>The admin API key is used for administrative operations like marking events as paid.</p>
                <pre><code>Authorization: Bearer your_admin_api_key</code></pre>
            </section>

            <section id="endpoints">
                <h2>API Endpoints</h2>

                <div class="endpoint">
                    <h3><span class="method post">POST</span><span class="path">/api/v1/letters</span></h3>
                    <p>Create a new letter. Requires an event API key.</p>
                    
                    <h4>Request Body</h4>
                    <table>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>first_name <span class="required">required</span></td>
                            <td>string</td>
                            <td>Recipient's first name</td>
                        </tr>
                        <tr>
                            <td>last_name <span class="required">required</span></td>
                            <td>string</td>
                            <td>Recipient's last name</td>
                        </tr>
                        <tr>
                            <td>address_line_1 <span class="required">required</span></td>
                            <td>string</td>
                            <td>Street address</td>
                        </tr>
                        <tr>
                            <td>address_line_2 <span class="optional">optional</span></td>
                            <td>string</td>
                            <td>Apartment, suite, etc.</td>
                        </tr>
                        <tr>
                            <td>city <span class="required">required</span></td>
                            <td>string</td>
                            <td>City name</td>
                        </tr>
                        <tr>
                            <td>state <span class="required">required</span></td>
                            <td>string</td>
                            <td>State/Province</td>
                        </tr>
                        <tr>
                            <td>postal_code <span class="required">required</span></td>
                            <td>string</td>
                            <td>ZIP/Postal code</td>
                        </tr>
                        <tr>
                            <td>country <span class="required">required</span></td>
                            <td>string</td>
                            <td>Country name (e.g., "Canada", "United States")</td>
                        </tr>
                        <tr>
                            <td>recipient_email <span class="optional">optional</span></td>
                            <td>string</td>
                            <td>Email for tracking notifications</td>
                        </tr>
                        <tr>
                            <td>mail_type <span class="required">required</span></td>
                            <td>string</td>
                            <td>"lettermail", "bubble_packet", or "parcel"</td>
                        </tr>
                        <tr>
                            <td>weight_grams <span class="optional">conditional</span></td>
                            <td>integer</td>
                            <td>Required for bubble_packet and parcel</td>
                        </tr>
                        <tr>
                            <td>rubber_stamps <span class="required">required</span></td>
                            <td>string</td>
                            <td>Items to pack (see <a href="#rubber-stamps">Rubber Stamps</a>)</td>
                        </tr>
                        <tr>
                            <td>notes <span class="optional">optional</span></td>
                            <td>string</td>
                            <td>Additional metadata</td>
                        </tr>
                    </table>

                    <h4>Response</h4>
                    <pre><code>{
  "letter_id": "ltr!32jhyrnk",
  "cost_usd": 1.19,
  "formatted_rubber_stamps": "1x pack of\nstickers\n1x Postcard",
  "status": "queued",
  "theseus_url": "https://mail.hackclub.com/back_office/letters/ltr!32jhyrnk",
  "email_sent": true
}</code></pre>
                    <p><em>A confirmation email will be sent to the recipient if an email address was provided.</em></p>
                </div>

                <div class="endpoint">
                    <h3><span class="method post">POST</span><span class="path">/admin/events/{event_id}/mark-paid</span></h3>
                    <p>Mark an event as paid. Requires admin API key.</p>
                    
                    <h4>Response</h4>
                    <pre><code>{
  "event_id": 1,
  "event_name": "Haxmas 2024",
  "previous_balance_cents": 15430,
  "new_balance_cents": 0,
  "is_paid": true
}</code></pre>
                </div>

                <div class="endpoint">
                    <h3><span class="method get">GET</span><span class="path">/admin/financial-summary</span></h3>
                    <p>Get a summary of all unpaid events. Requires admin API key.</p>
                    
                    <h4>Response</h4>
                    <pre><code>{
  "unpaid_events": [
    {
      "event_id": 1,
      "event_name": "Haxmas 2024",
      "balance_due_usd": 154.30,
      "letter_count": 127,
      "last_letter_at": "2025-01-09T14:32:00Z"
    }
  ],
  "total_due_usd": 154.30
}</code></pre>
                </div>

                <div class="endpoint">
                    <h3><span class="method post">POST</span><span class="path">/admin/check-letter-status</span></h3>
                    <p>Manually trigger a status check for all pending letters. Requires admin API key.</p>
                    
                    <h4>Response</h4>
                    <pre><code>{
  "checked": 47,
  "updated": 12,
  "mailed": 5
}</code></pre>
                </div>

                <div class="endpoint">
                    <h3><span class="method post">POST</span><span class="path">/api/v1/order</span></h3>
                    <p>Create a new order request. The Hermes team will order from a local carrier and ship to the recipient. Charged to your event's HCB. <strong>$1 fee per item.</strong></p>
                    
                    <h4>Request Body</h4>
                    <table>
                        <tr>
                            <th>Field</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>order_text <span class="required">required</span></td>
                            <td>string</td>
                            <td>Description of what to order (max 5000 chars). <strong>Do NOT include names/addresses here</strong> - use the dedicated fields below.</td>
                        </tr>
                        <tr>
                            <td>first_name <span class="required">required</span></td>
                            <td>string</td>
                            <td>Recipient's first name (not stored)</td>
                        </tr>
                        <tr>
                            <td>last_name <span class="required">required</span></td>
                            <td>string</td>
                            <td>Recipient's last name (not stored)</td>
                        </tr>
                        <tr>
                            <td>email <span class="optional">optional</span></td>
                            <td>string</td>
                            <td>Recipient's email (not stored)</td>
                        </tr>
                        <tr>
                            <td>phone_number <span class="optional">optional</span></td>
                            <td>string</td>
                            <td>Recipient's phone number, max 50 chars (not stored)</td>
                        </tr>
                        <tr>
                            <td>address_line_1 <span class="required">required</span></td>
                            <td>string</td>
                            <td>Street address (not stored)</td>
                        </tr>
                        <tr>
                            <td>address_line_2 <span class="optional">optional</span></td>
                            <td>string</td>
                            <td>Apartment, suite, etc. (not stored)</td>
                        </tr>
                        <tr>
                            <td>city <span class="required">required</span></td>
                            <td>string</td>
                            <td>City name (not stored)</td>
                        </tr>
                        <tr>
                            <td>state <span class="required">required</span></td>
                            <td>string</td>
                            <td>State/Province (not stored)</td>
                        </tr>
                        <tr>
                            <td>postal_code <span class="required">required</span></td>
                            <td>string</td>
                            <td>ZIP/Postal code (not stored)</td>
                        </tr>
                        <tr>
                            <td>country <span class="required">required</span></td>
                            <td>string</td>
                            <td>Country name (not stored)</td>
                        </tr>
                        <tr>
                            <td>order_notes <span class="optional">optional</span></td>
                            <td>string</td>
                            <td>Special delivery instructions or notes, max 1000 chars (not stored)</td>
                        </tr>
                    </table>

                    <h4>Response</h4>
                    <pre><code>{
  "order_id": "aB3xK9m",
  "status": "pending",
  "status_url": "https://fulfillment.hackclub.com/odr!aB3xK9m",
  "created_at": "2025-01-16T10:30:00Z",
  "email_sent": true
}</code></pre>
                    <p><em>A confirmation email will be sent to the recipient if an email address was provided.</em></p>

                    <h4>Example: GitHub Notebook</h4>
                    <pre><code>curl -X POST https://fulfillment.hackclub.com/api/v1/order \
  -H "Authorization: Bearer YOUR_EVENT_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "order_text": "GitHub Notebook - 1x black hardcover, 100 pages",
    "first_name": "Orpheus",
    "last_name": "Hacksworth",
    "email": "orpheus@hackclub.com",
    "phone_number": "+1-555-123-4567",
    "address_line_1": "123 Hacker Way",
    "city": "Shelburne",
    "state": "VT",
    "postal_code": "05482",
    "country": "United States",
    "order_notes": "Door code is 1234"
  }'</code></pre>
                </div>

                <div class="endpoint">
                    <h3><span class="method get">GET</span><span class="path">/odr!{order_id}</span></h3>
                    <p>Public order status page. Shows pending/fulfilled status with tracking code (no personal information displayed).</p>
                    
                    <h4>Status Display</h4>
                    <ul style="margin-left: 24px; margin-bottom: 16px;">
                        <li><strong>Pending:</strong> Shows "Your order is being processed"</li>
                        <li><strong>Fulfilled:</strong> Shows fulfillment note and tracking code if provided</li>
                    </ul>
                </div>

                <div class="endpoint">
                    <h3><span class="method get">GET</span><span class="path">/api/v1/order/{order_id}/status</span></h3>
                    <p>Get order status via API (public endpoint, no auth required).</p>
                    
                    <h4>Response</h4>
                    <pre><code>{
  "order_id": "aB3xK9m",
  "status": "fulfilled",
  "tracking_code": "1Z999AA10123456784",
  "fulfillment_note": "Shipped via UPS Ground",
  "created_at": "2025-01-16T10:30:00Z",
  "fulfilled_at": "2025-01-17T14:00:00Z"
}</code></pre>
                </div>
            </section>

            <section id="orders">
                <h2>Orders</h2>
                <p>The Orders API allows you to request items that the Hermes team will order from a local carrier and ship to the recipient. Orders are charged to your event's HCB account.</p>

                <div class="note-box">
                    <strong>ðŸ’µ Pricing:</strong> There is a <strong>$1 fee per item</strong> ordered, plus actual shipping costs. All charges go to your event's HCB.
                </div>

                <div class="note-box">
                    <strong>How it works:</strong> Submit an order with shipping address â†’ Jenin orders from local carrier â†’ Ships to recipient â†’ Charged to your HCB â†’ Status page updates with tracking.
                </div>

                <h3>Order Flow</h3>
                <ol style="margin-left: 24px; margin-bottom: 16px;">
                    <li>Send a POST request to <code class="inline-code">/api/v1/order</code> with order details and shipping address</li>
                    <li>Receive an order ID and status URL (e.g., <code class="inline-code">fulfillment.hackclub.com/odr!aB3xK9m</code>)</li>
                    <li>Share the status URL with the recipient</li>
                    <li>Hermes team orders items from local carrier and ships to the provided address</li>
                    <li>Costs are charged to your event's HCB account</li>
                    <li>Once fulfilled, status page shows tracking code and notes</li>
                </ol>

                <h3>Example: Ordering a GitHub Notebook</h3>
                
                <div class="tabs">
                    <div class="tab active" onclick="switchOrderTab('order-curl')">cURL</div>
                    <div class="tab" onclick="switchOrderTab('order-python')">Python</div>
                </div>

                <div id="order-curl" class="tab-content active">
                    <pre><code>curl -X POST https://fulfillment.hackclub.com/api/v1/order \
  -H "Authorization: Bearer YOUR_EVENT_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "order_text": "GitHub Notebook - 1x black hardcover, 100 pages",
    "first_name": "Orpheus",
    "last_name": "Hacksworth",
    "email": "orpheus@hackclub.com",
    "phone_number": "+1-555-123-4567",
    "address_line_1": "123 Hacker Way",
    "city": "Shelburne",
    "state": "VT",
    "postal_code": "05482",
    "country": "United States",
    "order_notes": "Door code is 1234"
  }'</code></pre>
                </div>

                <div id="order-python" class="tab-content">
                    <pre><code>import requests

response = requests.post(
    "https://fulfillment.hackclub.com/api/v1/order",
    headers={
        "Authorization": "Bearer YOUR_EVENT_API_KEY",
        "Content-Type": "application/json"
    },
    json={
        "order_text": "GitHub Notebook - 1x black hardcover, 100 pages",
        "first_name": "Orpheus",
        "last_name": "Hacksworth",
        "email": "orpheus@hackclub.com",
        "phone_number": "+1-555-123-4567",
        "address_line_1": "123 Hacker Way",
        "city": "Shelburne",
        "state": "VT",
        "postal_code": "05482",
        "country": "United States",
        "order_notes": "Door code is 1234"
    }
)

print(response.json())</code></pre>
                </div>

                <h3>Privacy &amp; Security</h3>
                <p>Shipping addresses are <strong>NEVER stored in the database</strong>. PII is:</p>
                <ul style="margin-left: 24px; margin-bottom: 16px;">
                    <li>Sent directly to the Slack #mail channel when the order is created</li>
                    <li>Visible only in that one Slack message</li>
                    <li>Never stored, cached, or logged anywhere</li>
                    <li>Cannot be retrieved from the API or database</li>
                </ul>
                
                <p>The public status page (<code class="inline-code">/odr!{id}</code>) only shows:</p>
                <ul style="margin-left: 24px; margin-bottom: 16px;">
                    <li>Order ID</li>
                    <li>Status (Pending or Fulfilled)</li>
                    <li>Tracking code (if provided)</li>
                    <li>Fulfillment note (if provided)</li>
                </ul>
                <p><strong>No personal information</strong> (names, addresses, etc.) is ever displayed on the public status page.</p>
            </section>

            <section id="calculator">
                <h2>Cost Calculator</h2>
                <p>Use this calculator to estimate shipping costs before creating letters.</p>

                <div class="calculator">
                    <h3>Estimate Shipping Cost</h3>
                    
                    <div class="form-group">
                        <label for="country">Destination Country</label>
                        <select id="country">
                            <option value="Canada">Canada</option>
                            <option value="United States">United States</option>
                            <option value="International">Other (International)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="mail_type">Mail Type</label>
                        <select id="mail_type" onchange="updateWeightVisibility()">
                            <option value="lettermail">Lettermail (up to 30g)</option>
                            <option value="bubble_packet">Bubble Packet (up to 500g)</option>
                            <option value="parcel">Parcel (custom quote)</option>
                        </select>
                    </div>

                    <div class="form-group" id="weight-group" style="display: none;">
                        <label for="weight">Weight (grams)</label>
                        <input type="number" id="weight" min="1" max="500" placeholder="Enter weight in grams">
                    </div>

                    <button onclick="calculateCost()" style="width: 100%; padding: 12px; background: var(--accent-color); color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer;">
                        Calculate Cost
                    </button>

                    <div class="result" id="result" style="display: none;">
                        <div class="result-amount" id="result-amount">$0.00</div>
                        <div class="result-note" id="result-note"></div>
                    </div>
                </div>

                <h3 style="margin-top: 32px;">Mail Type Limits</h3>
                <table>
                    <tr>
                        <th>Type</th>
                        <th>Max Weight</th>
                        <th>Max Dimensions</th>
                    </tr>
                    <tr>
                        <td>Lettermail</td>
                        <td>30g</td>
                        <td>245mm Ã— 156mm Ã— 5mm (9.6" Ã— 6.1" Ã— 0.2")</td>
                    </tr>
                    <tr>
                        <td>Bubble Packet</td>
                        <td>500g</td>
                        <td>380mm Ã— 270mm Ã— 20mm (14.9" Ã— 10.6" Ã— 0.8")</td>
                    </tr>
                    <tr>
                        <td>Parcel</td>
                        <td colspan="2">Custom quote required - contact @jenin</td>
                    </tr>
                </table>
            </section>

            <section id="rubber-stamps">
                <h2>Rubber Stamps Field</h2>
                <p>The <code class="inline-code">rubber_stamps</code> field specifies what items should be packed in the envelope. This text gets printed on the fulfillment label.</p>

                <div class="note-box">
                    <strong>Important:</strong> The API automatically formats text to fit within 11 characters per line for physical rubber stamps.
                </div>

                <h3>Format Guidelines</h3>
                <ul style="margin-left: 24px; margin-bottom: 16px;">
                    <li>List each item on its own line</li>
                    <li>Use clear, descriptive text</li>
                    <li>Include quantities if applicable</li>
                    <li>Use <code class="inline-code">\n</code> for line breaks in JSON</li>
                </ul>

                <h3>Good Examples</h3>
                <pre><code>"rubber_stamps": "1x pack of stickers\n1x Postcard of Euan eating a Bread"</code></pre>
                <pre><code>"rubber_stamps": "3x Hack Club stickers\n1x Thank you card\n1x Event badge"</code></pre>
                <pre><code>"rubber_stamps": "Haxmas 2024 Winner Prize Package"</code></pre>

                <h3>Bad Examples</h3>
                <pre><code>"rubber_stamps": "stuff"  // Too vague - what should be packed?</code></pre>
                <pre><code>"rubber_stamps": ""  // Empty - not allowed</code></pre>
            </section>

            <section id="examples">
                <h2>Code Examples</h2>

                <div class="tabs">
                    <div class="tab active" onclick="switchTab('curl')">cURL</div>
                    <div class="tab" onclick="switchTab('python')">Python</div>
                    <div class="tab" onclick="switchTab('javascript')">JavaScript</div>
                </div>

                <div id="curl" class="tab-content active">
                    <pre><code>curl -X POST https://your-api.com/api/v1/letters \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "first_name": "John",
    "last_name": "Doe",
    "address_line_1": "123 Main St",
    "city": "Burlington",
    "state": "VT",
    "postal_code": "05401",
    "country": "Canada",
    "mail_type": "lettermail",
    "rubber_stamps": "1x pack of stickers\n1x Postcard"
  }'</code></pre>
                </div>

                <div id="python" class="tab-content">
                    <pre><code>import requests

response = requests.post(
    "https://your-api.com/api/v1/letters",
    headers={
        "Authorization": "Bearer YOUR_API_KEY",
        "Content-Type": "application/json"
    },
    json={
        "first_name": "John",
        "last_name": "Doe",
        "address_line_1": "123 Main St",
        "city": "Burlington",
        "state": "VT",
        "postal_code": "05401",
        "country": "Canada",
        "mail_type": "lettermail",
        "rubber_stamps": "1x pack of stickers\n1x Postcard"
    }
)

print(response.json())</code></pre>
                </div>

                <div id="javascript" class="tab-content">
                    <pre><code>const response = await fetch('https://your-api.com/api/v1/letters', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    first_name: 'John',
    last_name: 'Doe',
    address_line_1: '123 Main St',
    city: 'Burlington',
    state: 'VT',
    postal_code: '05401',
    country: 'Canada',
    mail_type: 'lettermail',
    rubber_stamps: '1x pack of stickers\n1x Postcard'
  })
});

const data = await response.json();
console.log(data);</code></pre>
                </div>
            </section>

            <section id="playground">
                <h2>API Playground</h2>
                <p>Test the API directly from your browser. Enter your API key and send requests â€” everything runs locally, nothing is stored.</p>

                <div class="note-box">
                    <strong>Privacy:</strong> Your API key and request data are only sent directly to the API. Nothing is stored or logged by this page.
                </div>

                <div class="playground-container" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 24px; margin-top: 24px;">
                    <div class="form-group">
                        <label for="api-key">API Key</label>
                        <input type="password" id="api-key" placeholder="Enter your API key" style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                    </div>

                    <div class="form-group">
                        <label for="endpoint-select">Endpoint</label>
                        <select id="endpoint-select" onchange="updatePlaygroundForm()" style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            <option value="letters">POST /api/v1/letters - Create Letter</option>
                            <option value="order">POST /api/v1/order - Create Order</option>
                            <option value="order-status">GET /api/v1/order/{id}/status - Order Status</option>
                        </select>
                    </div>

                    <div id="playground-form-letters" class="playground-form">
                        <h4 style="margin: 16px 0;">Request Body</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div class="form-group">
                                <label for="pg-first-name">First Name *</label>
                                <input type="text" id="pg-first-name" placeholder="John" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-last-name">Last Name *</label>
                                <input type="text" id="pg-last-name" placeholder="Doe" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="pg-address1">Address Line 1 *</label>
                                <input type="text" id="pg-address1" placeholder="123 Main St" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="pg-address2">Address Line 2</label>
                                <input type="text" id="pg-address2" placeholder="Apt 4B" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-city">City *</label>
                                <input type="text" id="pg-city" placeholder="Burlington" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-state">State/Province *</label>
                                <input type="text" id="pg-state" placeholder="VT" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-postal">Postal Code *</label>
                                <input type="text" id="pg-postal" placeholder="05401" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-country">Country *</label>
                                <input type="text" id="pg-country" placeholder="Canada" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-email">Recipient Email</label>
                                <input type="email" id="pg-email" placeholder="john@example.com" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-mail-type">Mail Type *</label>
                                <select id="pg-mail-type" onchange="updateWeightField()" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                                    <option value="lettermail">Lettermail</option>
                                    <option value="bubble_packet">Bubble Packet</option>
                                    <option value="parcel">Parcel</option>
                                </select>
                            </div>
                            <div class="form-group" id="pg-weight-group" style="display: none;">
                                <label for="pg-weight">Weight (grams) *</label>
                                <input type="number" id="pg-weight" placeholder="100" min="1" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="pg-rubber-stamps">Rubber Stamps *</label>
                                <textarea id="pg-rubber-stamps" rows="3" placeholder="1x pack of stickers&#10;1x Postcard" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary); resize: vertical;"></textarea>
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="pg-notes">Notes</label>
                                <input type="text" id="pg-notes" placeholder="Optional notes" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                        </div>
                    </div>

                    <div id="playground-form-order" class="playground-form" style="display: none;">
                        <h4 style="margin: 16px 0;">Request Body</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="pg-order-text">Order Text *</label>
                                <textarea id="pg-order-text" rows="3" placeholder="GitHub Notebook - 1x black hardcover, 100 pages" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary); resize: vertical;"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="pg-order-first-name">First Name *</label>
                                <input type="text" id="pg-order-first-name" placeholder="Orpheus" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-order-last-name">Last Name *</label>
                                <input type="text" id="pg-order-last-name" placeholder="Hacksworth" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-order-email">Email</label>
                                <input type="email" id="pg-order-email" placeholder="orpheus@hackclub.com" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-order-phone">Phone Number</label>
                                <input type="tel" id="pg-order-phone" placeholder="+1-555-123-4567" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="pg-order-address1">Address Line 1 *</label>
                                <input type="text" id="pg-order-address1" placeholder="123 Hacker Way" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="pg-order-address2">Address Line 2</label>
                                <input type="text" id="pg-order-address2" placeholder="" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-order-city">City *</label>
                                <input type="text" id="pg-order-city" placeholder="Shelburne" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-order-state">State/Province *</label>
                                <input type="text" id="pg-order-state" placeholder="VT" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-order-postal">Postal Code *</label>
                                <input type="text" id="pg-order-postal" placeholder="05482" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group">
                                <label for="pg-order-country">Country *</label>
                                <input type="text" id="pg-order-country" placeholder="United States" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="pg-order-notes">Delivery Instructions / Notes</label>
                                <textarea id="pg-order-notes" rows="2" placeholder="Door code is 1234" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary); resize: vertical;"></textarea>
                            </div>
                        </div>
                    </div>

                    <div id="playground-form-order-status" class="playground-form" style="display: none;">
                        <h4 style="margin: 16px 0;">Request Parameters</h4>
                        <div class="form-group">
                            <label for="pg-order-id">Order ID *</label>
                            <input type="text" id="pg-order-id" placeholder="aB3xK9m" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
                        </div>
                    </div>

                    <button onclick="sendPlaygroundRequest()" id="playground-send-btn" style="width: 100%; padding: 12px; background: var(--accent-color); color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; margin-top: 16px;">
                        Send Request
                    </button>

                    <div id="playground-response" style="display: none; margin-top: 24px;">
                        <h4 style="margin-bottom: 12px;">Response <span id="response-status" style="font-weight: normal; font-size: 14px;"></span></h4>
                        <pre id="playground-response-body" style="white-space: pre-wrap; word-wrap: break-word;"><code></code></pre>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script>
        function toggleTheme() {
            const body = document.body;
            if (body.hasAttribute('data-theme')) {
                body.removeAttribute('data-theme');
            } else {
                body.setAttribute('data-theme', 'dark');
            }
        }

        function updateWeightVisibility() {
            const mailType = document.getElementById('mail_type').value;
            const weightGroup = document.getElementById('weight-group');
            weightGroup.style.display = mailType === 'lettermail' ? 'none' : 'block';
        }

        function calculateCost() {
            const country = document.getElementById('country').value;
            const mailType = document.getElementById('mail_type').value;
            const weight = parseInt(document.getElementById('weight').value) || 0;

            let costCents = 0;
            let note = '';

            if (mailType === 'parcel') {
                document.getElementById('result-amount').textContent = 'Custom Quote';
                document.getElementById('result-note').textContent = 'Please DM @jenin on Slack for parcel rates.';
                document.getElementById('result').style.display = 'block';
                return;
            }

            if (mailType === 'lettermail') {
                if (country === 'Canada') costCents = 175;
                else if (country === 'United States') costCents = 200;
                else costCents = 350;
                note = 'Max 30g, 245mm Ã— 156mm Ã— 5mm';
            } else if (mailType === 'bubble_packet') {
                if (weight > 500) {
                    document.getElementById('result-amount').textContent = 'Too Heavy';
                    document.getElementById('result-note').textContent = 'Weight exceeds 500g. Use parcel instead.';
                    document.getElementById('result').style.display = 'block';
                    return;
                }

                if (country === 'Canada') {
                    if (weight <= 100) costCents = 311;
                    else if (weight <= 200) costCents = 451;
                    else if (weight <= 300) costCents = 591;
                    else if (weight <= 400) costCents = 662;
                    else costCents = 705;
                } else if (country === 'United States') {
                    if (weight <= 100) costCents = 451;
                    else if (weight <= 200) costCents = 716;
                    else costCents = 1338;
                } else {
                    if (weight <= 100) costCents = 808;
                    else if (weight <= 200) costCents = 1338;
                    else costCents = 2580;
                }
                note = 'Max 500g, 380mm Ã— 270mm Ã— 20mm';
            }

            const costUsd = (costCents / 100).toFixed(2);
            document.getElementById('result-amount').textContent = `$${costUsd} USD`;
            document.getElementById('result-note').textContent = note;
            document.getElementById('result').style.display = 'block';
        }

        function switchTab(tabName) {
            document.querySelectorAll('#examples .tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('#examples .tab-content').forEach(t => t.classList.remove('active'));
            
            document.querySelector(`.tab-content#${tabName}`).classList.add('active');
            event.target.classList.add('active');
        }

        function switchOrderTab(tabName) {
            document.querySelectorAll('#orders .tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('#orders .tab-content').forEach(t => t.classList.remove('active'));
            
            document.querySelector(`.tab-content#${tabName}`).classList.add('active');
            event.target.classList.add('active');
        }

        const API_BASE = 'https://fulfillment.hackclub.com';

        function updatePlaygroundForm() {
            const endpoint = document.getElementById('endpoint-select').value;
            document.querySelectorAll('.playground-form').forEach(f => f.style.display = 'none');
            
            if (endpoint === 'letters') {
                document.getElementById('playground-form-letters').style.display = 'block';
            } else if (endpoint === 'order') {
                document.getElementById('playground-form-order').style.display = 'block';
            } else if (endpoint === 'order-status') {
                document.getElementById('playground-form-order-status').style.display = 'block';
            }
            
            document.getElementById('playground-response').style.display = 'none';
        }

        function updateWeightField() {
            const mailType = document.getElementById('pg-mail-type').value;
            document.getElementById('pg-weight-group').style.display = 
                mailType === 'lettermail' ? 'none' : 'block';
        }

        async function sendPlaygroundRequest() {
            const apiKey = document.getElementById('api-key').value;
            const endpoint = document.getElementById('endpoint-select').value;
            const btn = document.getElementById('playground-send-btn');
            const responseDiv = document.getElementById('playground-response');
            const responseBody = document.getElementById('playground-response-body').querySelector('code');
            const responseStatus = document.getElementById('response-status');

            if (endpoint !== 'order-status' && !apiKey) {
                alert('Please enter your API key');
                return;
            }

            btn.textContent = 'Sending...';
            btn.disabled = true;

            try {
                let url, method, body, headers = {};

                if (endpoint === 'letters') {
                    url = `${API_BASE}/api/v1/letters`;
                    method = 'POST';
                    headers = {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    };
                    const data = {
                        first_name: document.getElementById('pg-first-name').value,
                        last_name: document.getElementById('pg-last-name').value,
                        address_line_1: document.getElementById('pg-address1').value,
                        city: document.getElementById('pg-city').value,
                        state: document.getElementById('pg-state').value,
                        postal_code: document.getElementById('pg-postal').value,
                        country: document.getElementById('pg-country').value,
                        mail_type: document.getElementById('pg-mail-type').value,
                        rubber_stamps: document.getElementById('pg-rubber-stamps').value
                    };
                    
                    const address2 = document.getElementById('pg-address2').value;
                    if (address2) data.address_line_2 = address2;
                    
                    const email = document.getElementById('pg-email').value;
                    if (email) data.recipient_email = email;
                    
                    const notes = document.getElementById('pg-notes').value;
                    if (notes) data.notes = notes;
                    
                    const mailType = document.getElementById('pg-mail-type').value;
                    if (mailType !== 'lettermail') {
                        const weight = document.getElementById('pg-weight').value;
                        if (weight) data.weight_grams = parseInt(weight);
                    }
                    
                    body = JSON.stringify(data);
                } else if (endpoint === 'order') {
                    url = `${API_BASE}/api/v1/order`;
                    method = 'POST';
                    headers = {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    };
                    const data = {
                        order_text: document.getElementById('pg-order-text').value,
                        first_name: document.getElementById('pg-order-first-name').value,
                        last_name: document.getElementById('pg-order-last-name').value,
                        address_line_1: document.getElementById('pg-order-address1').value,
                        city: document.getElementById('pg-order-city').value,
                        state: document.getElementById('pg-order-state').value,
                        postal_code: document.getElementById('pg-order-postal').value,
                        country: document.getElementById('pg-order-country').value
                    };
                    
                    const address2 = document.getElementById('pg-order-address2').value;
                    if (address2) data.address_line_2 = address2;
                    
                    const email = document.getElementById('pg-order-email').value;
                    if (email) data.email = email;
                    
                    const phone = document.getElementById('pg-order-phone').value;
                    if (phone) data.phone_number = phone;
                    
                    const orderNotes = document.getElementById('pg-order-notes').value;
                    if (orderNotes) data.order_notes = orderNotes;
                    
                    body = JSON.stringify(data);
                } else if (endpoint === 'order-status') {
                    const orderId = document.getElementById('pg-order-id').value;
                    if (!orderId) {
                        alert('Please enter an order ID');
                        btn.textContent = 'Send Request';
                        btn.disabled = false;
                        return;
                    }
                    url = `${API_BASE}/api/v1/order/${orderId}/status`;
                    method = 'GET';
                }

                const response = await fetch(url, {
                    method,
                    headers,
                    body
                });

                const responseData = await response.json();
                
                responseStatus.textContent = `(${response.status} ${response.statusText})`;
                responseStatus.style.color = response.ok ? 'var(--success-color)' : 'var(--error-color)';
                responseBody.textContent = JSON.stringify(responseData, null, 2);
                responseDiv.style.display = 'block';
            } catch (error) {
                responseStatus.textContent = '(Error)';
                responseStatus.style.color = 'var(--error-color)';
                responseBody.textContent = error.message;
                responseDiv.style.display = 'block';
            } finally {
                btn.textContent = 'Send Request';
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
